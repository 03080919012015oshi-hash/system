<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VigenÃ¨re Cipher</title>

<style>
:root {
  --bg: #f2f4f8;
  --card: #ffffff;
  --accent: #4f7cff;
  --text: #222;
  --sub: #666;
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg: #121212;
    --card: #1e1e1e;
    --accent: #7aa2ff;
    --text: #f0f0f0;
    --sub: #aaa;
  }
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--bg);
  color: var(--text);
}

.container {
  max-width: 480px;
  margin: auto;
  padding: 20px;
}

h1 {
  font-size: 22px;
  text-align: center;
  margin-bottom: 20px;
}

.card {
  background: var(--card);
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  margin-bottom: 16px;
}

label {
  font-size: 13px;
  color: var(--sub);
}

textarea, input {
  width: 100%;
  margin-top: 6px;
  padding: 12px;
  border-radius: 12px;
  border: none;
  background: #e9ecf3;
  font-size: 16px;
}

@media (prefers-color-scheme: dark) {
  textarea, input {
    background: #2a2a2a;
    color: var(--text);
  }
}

textarea {
  resize: none;
}

.buttons {
  display: flex;
  gap: 12px;
}

button {
  flex: 1;
  border: none;
  border-radius: 14px;
  padding: 14px;
  font-size: 16px;
  font-weight: bold;
  cursor: pointer;
}

.encrypt {
  background: var(--accent);
  color: white;
}

.decrypt {
  background: #aaa;
  color: white;
}

footer {
  text-align: center;
  font-size: 12px;
  color: var(--sub);
  margin-top: 10px;
}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ” VigenÃ¨re æš—å·</h1>

<div class="card">
  <label>å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆ</label>
  <textarea id="text" rows="4" placeholder="æ–‡ç« ã‚’å…¥åŠ›"></textarea>
</div>

<div class="card">
  <label>éµï¼ˆã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆï¼‰</label>
  <input id="key" placeholder="ä¾‹: secret">
</div>

<div class="buttons">
  <button class="encrypt" onclick="run(true)">æš—å·åŒ–</button>
  <button class="decrypt" onclick="run(false)">å¾©å·</button>
</div>

<div class="card">
  <label>çµæœ</label>
  <textarea id="result" rows="4" readonly></textarea>
</div>

<footer>
  a=16 VigenÃ¨re Cipher
</footer>

</div>

<script>
const chars =
  "ABCDEFGHIJKLMNOPQRSTUVWXYZ" +
  "abcdefghijklmnopqrstuvwxyz" +
  "0123456789" +
  "!\"#$%&'()=~-^\\|@[]{};:+*,./_";

function keyCharToShift(c) {
  const code = c.toLowerCase().charCodeAt(0);
  return (code >= 97 && code <= 122) ? (code - 96 + 15) : 0;
}

function vigenere(text, key, encrypt=true) {
  let res = "";
  let ki = 0;
  const len = chars.length;

  for (const ch of text) {
    const i = chars.indexOf(ch);
    if (i === -1) {
      res += ch;
      continue;
    }

    const shift = keyCharToShift(key[ki % key.length]) * (encrypt ? 1 : -1);
    res += chars[(i + shift + len) % len];
    ki++;
  }
  return res;
}

function run(encrypt) {
  const text = document.getElementById("text").value;
  const key = document.getElementById("key").value;

  if (!key.match(/^[a-zA-Z]+$/)) {
    alert("éµã¯ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã®ã¿ä½¿ç”¨ã§ãã¾ã™");
    return;
  }

  document.getElementById("result").value =
    vigenere(text, key, encrypt);
}
</script>

</body>
</html>
